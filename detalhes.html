<!DOCTYPE html>
<html lang="pt-BR">

<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Detalhes da Vulnerabilidade</title>
    <link rel="stylesheet" href="detalhes.css" />
</head>

<body>

    <div class="sidebar">
        <div>
            <div class="logo-box">
                <img src="assets/logo.png" alt="Logo"
                    style="height: 45px; vertical-align: middle; margin-right: 8px;" />
                <img src="assets/zvulny_blue.png" alt="zVulny" style="height: 36px; vertical-align: middle;" />
            </div>
            <div class="menu">
                <a href="escanear.html">
                    <img src="assets/shield.png" alt="Escanear"
                        style="height: 20px; vertical-align: middle; margin-right: 8px;" />
                    Escanear
                </a>
                <div class="divider"></div>
                <a href="mapear.html" class="active">
                    <img src="assets/locate.png" alt="Mapear"
                        style="height: 20px; vertical-align: middle; margin-right: 8px;" />
                    Mapear
                </a>
                <div class="divider"></div>
                <a href="analise.html">
                    <img src="assets/analytics.png" alt="Análise"
                        style="height: 20px; vertical-align: middle; margin-right: 8px;" />
                    Análise
                </a>
                <div class="divider"></div>
                <a href="sugestao.html">
                    <img src="assets/lamp.png" alt="Sugestão"
                        style="height: 20px; vertical-align: middle; margin-right: 8px;" />
                    Sugestão
                </a>
            </div>
        </div>
        <a href="logout.html" class="logout">
            <img src="assets/logout.png" alt="Logout"
                style="height: 20px; vertical-align: middle; margin-right: 8px;" />
            Logout
        </a>
    </div>

    <main class="main-content">
        <div class="titulo-detalhe">
            <img id="voltar" src="assets/arrow-back.png" alt="Voltar" />
            <h1>Detalhes da Vulnerabilidade</h1>
        </div>


        <div class="campo"><strong>ID/CVE:</strong> <span id="cve"></span></div>
        <div class="campo"><strong>CVSS:</strong> <span id="cvss"></span></div>
        <div class="campo"><strong>Descrição:</strong>
            <p id="descricao"></p>
        </div>
        <div class="campo"><strong>Serviço/Porta:</strong> <span id="servico"></span></div>
        <div class="campo"><strong>Protocolo:</strong> <span id="protocolo"></span></div>
        <div class="campo"><strong>Vendor/Produto:</strong> <span id="produto"></span></div>
        <div class="campo"><strong>Data da Descoberta:</strong> <span id="data"></span></div>
        <div class="campo"><strong>Tipo da Vulnerabilidade:</strong> <span id="tipo"></span></div>
        <div class="campo"><strong>Exploit Disponível:</strong> <span id="exploit"></span></div>
        <div class="campo"><strong>Host/IP Afetado:</strong> <span id="ip"></span></div>
    </main>

    <script>
        document.addEventListener('DOMContentLoaded', () => {
            const v = JSON.parse(sessionStorage.getItem('vulnDetalhe') || '{}');
            if (!v['ID/CVE']) {
                document.querySelector('main').innerHTML = '<p>Nenhum dado disponível. Retorne à dashboard.</p>';
                return;
            }
            document.getElementById('cve').textContent = v['ID/CVE'];
            document.getElementById('cvss').textContent = v['CVSS'] || 'N/A';
            document.getElementById('descricao').textContent = v['Descricao'] || 'N/A';
            document.getElementById('servico').textContent = v['Serviço/Porta'] || 'N/A';
            document.getElementById('protocolo').textContent = v['Protocolo'] || 'N/A';
            document.getElementById('produto').textContent = v['Vendor/Produto'] || 'N/A';
            document.getElementById('data').textContent = v['Data da Descoberta'] || 'N/A';
            document.getElementById('tipo').textContent = v['Tipo da Vulnerabilidade'] || 'N/A';
            document.getElementById('exploit').textContent = v['Exploit Disponível'] || 'N/A';
            document.getElementById('ip').textContent = v['Host/IP Afetado'] || 'N/A';
        });

        document.getElementById('voltar').addEventListener('click', () => history.back());
    </script>

</body>

</html>